import { createRoot } from 'react-dom/client';
import './popUp.css';
import { supabase } from '../../lib/supabaseClient';
import { useEffect, useState } from 'react';

function PopUp() {

    const [login, setLogin] = useState(false);
    const [user, setUser] = useState({ email: '' });
    const [totalNum, setTotalNum] = useState(0);

    useEffect(() => {
        supabase.auth.getSession().then(res => {
            if (res.data.session) {
                setLogin(true);
                setUser(res.data.session.user);
                supabase.from('words')
                    .select('*', { count: 'estimated', head: true })
                    .eq('user', res.data.session.user.id)
                    .then(res => {
                        console.log(res);
                        setTotalNum(res.count);
                    });
            }
        })
    }, []);

    return (
        <div className="outer-most">
            {
                login ? <div className='head'>
                    <svg width="22" height="22" viewBox="0 0 22 22">
                        <g clip-path="url(#clip0_48_95)">
                            <path d="M11.0054 5.72734C10.5507 5.72734 10.1004 5.8169 9.68035 5.99091C9.26025 6.16492 8.87854 6.41997 8.55701 6.7415C8.23548 7.06303 7.98043 7.44474 7.80643 7.86483C7.63242 8.28493 7.54285 8.73519 7.54285 9.1899C7.54285 9.6446 7.63242 10.0949 7.80643 10.515C7.98043 10.9351 8.23548 11.3168 8.55701 11.6383C8.87854 11.9598 9.26025 12.2149 9.68035 12.3889C10.1004 12.5629 10.5507 12.6524 11.0054 12.6524C11.9237 12.6524 12.8044 12.2876 13.4538 11.6383C14.1032 10.9889 14.468 10.1082 14.468 9.1899C14.468 8.27157 14.1032 7.39085 13.4538 6.7415C12.8044 6.09214 11.9237 5.72734 11.0054 5.72734ZM11.0054 14.0385C7.27396 14.0385 5.13874 15.3413 4.81363 17.8029C6.48605 19.3859 8.70137 20.2681 11.0042 20.2681C13.307 20.2681 15.5223 19.3859 17.1947 17.8029C16.8721 15.3413 14.7369 14.0385 11.0054 14.0385ZM11.0054 21.6566C8.95906 21.657 6.95815 21.053 5.25375 19.9205C3.54935 18.788 2.21737 17.1774 1.42494 15.2907C0.63251 13.404 0.414919 11.3253 0.799471 9.31539C1.18402 7.30549 2.15359 5.45392 3.58652 3.99301C5.48407 2.04765 8.07198 0.9287 10.7891 0.878784H11.0054C13.0516 0.878845 15.0521 1.48313 16.7561 2.61583C18.4602 3.74853 19.7918 5.3592 20.5839 7.24579C21.376 9.13239 21.5934 11.2109 21.2088 13.2206C20.8242 15.2302 19.8546 17.0816 18.4219 18.5423C16.5251 20.4867 13.9388 21.6056 11.223 21.6566H11.0054Z" fill="#98A6B4" />
                        </g>
                        <defs>
                            <clipPath id="clip0_48_95">
                                <rect width="22" height="22" fill="white" />
                            </clipPath>
                        </defs>
                    </svg>
                    <div>{user.email}</div>
                    <div>
                        <div>升级PRO</div>
                    </div>
                </div> :
                    <div className='head_nologin'>
                        <div onClick={() => {
                            chrome.tabs.create({
                                url: '../logIn.html'
                            });
                        }}>登录/注册</div>
                    </div>
            }
            <div className='list-item' onClick={() => {
                chrome.tabs.create({
                    url: '../../../home.html?item=0'
                });
            }}>
                <svg width="40" height="40" viewBox="0 0 57 57">
                    <path d="M13.6711 43.3345H47.5705C47.6763 43.3345 47.7765 43.3178 47.8711 43.2955H47.8934C48.617 43.2955 49.2071 42.7055 49.2071 41.9819V4.92073C49.2071 4.19709 48.617 3.60706 47.8934 3.60706H13.6711C10.181 3.60706 7.34212 6.44592 7.34212 9.93606C7.34212 9.98059 7.35325 10.0251 7.35325 10.0697C7.34769 13.2926 7.30872 42.917 7.34768 46.8079C7.34768 46.8859 7.33655 46.9582 7.33655 47.0362C7.33655 50.3927 9.9639 53.1369 13.2703 53.3485C13.3371 53.3596 13.4039 53.3707 13.4707 53.3707H47.8878C48.6115 53.3707 49.2015 52.7807 49.2015 52.0571V47.1197C49.2015 46.396 48.6115 45.806 47.8878 45.806C47.1642 45.806 46.5741 46.396 46.5741 47.1197V50.7434H13.6711C11.6783 50.7434 10.053 49.1625 9.96946 47.1865C9.96946 47.1531 9.98059 47.1197 9.97503 47.0807C9.97503 47.025 9.96946 46.9304 9.96946 46.8135C10.0919 44.882 11.7006 43.3345 13.6711 43.3345ZM14.5673 9.93606C14.5673 9.21243 15.1574 8.62239 15.881 8.62239C16.6046 8.62239 17.1947 9.21243 17.1947 9.93606V36.5769C17.1947 37.3005 16.6046 37.8906 15.881 37.8906C15.1574 37.8906 14.5673 37.3005 14.5673 36.5769V9.93606Z" fill="#B3C0CC" />
                </svg>
                <div>
                    <div className='title'>单词本</div>
                    {
                        login ?
                            <div className='description'>已标记<span>{totalNum}</span>个单词</div>
                            : null
                    }

                </div>
            </div>
            <div className='list-item' onClick={() => {
                chrome.tabs.create({
                    url: '../../../home.html?item=1'
                });
            }}>
                <svg width="40" height="40" viewBox="0 0 53 53" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M32.6834 45.05C32.6834 45.7001 32.1557 46.2278 31.5056 46.2278H22.0834C21.4332 46.2278 20.9056 45.7001 20.9056 45.05C20.9056 44.3999 21.4332 43.8722 22.0834 43.8722H31.5056C32.1557 43.8722 32.6834 44.3999 32.6834 45.05ZM31.5056 46.8167H22.0834C21.3084 46.8167 20.7083 47.5651 20.9662 48.3784C21.1217 48.8689 21.6181 49.1722 22.1328 49.1722H22.1505C22.8307 49.1722 23.4525 49.5568 23.757 50.1651L23.7693 50.1898C24.1798 51.0095 25.0178 51.5278 25.9347 51.5278H27.6542C28.5711 51.5278 29.4091 51.0095 29.819 50.1898L29.8314 50.1651C30.1358 49.5568 30.7577 49.1722 31.4379 49.1722H31.4555C31.9702 49.1722 32.4666 48.8689 32.6221 48.3784C32.8806 47.5651 32.2806 46.8167 31.5056 46.8167ZM26.7945 9.12776C27.4446 9.12776 27.9722 8.60012 27.9722 7.94999V3.23887C27.9722 2.58874 27.4446 2.0611 26.7945 2.0611C26.1443 2.0611 25.6167 2.58874 25.6167 3.23887V7.94999C25.6167 8.60012 26.1443 9.12776 26.7945 9.12776ZM14.3024 13.6122C14.532 13.8424 14.8335 13.9572 15.1351 13.9572C15.4366 13.9572 15.7381 13.8424 15.9677 13.6122C16.4277 13.1522 16.4277 12.4067 15.9677 11.9468L12.6364 8.61543C12.1771 8.15551 11.4304 8.15551 10.971 8.61543C10.5111 9.07535 10.5111 9.82088 10.971 10.2808L14.3024 13.6122ZM11.4834 24.4389C11.4834 23.7887 10.9557 23.2611 10.3056 23.2611H5.59446C4.94433 23.2611 4.41669 23.7887 4.41669 24.4389C4.41669 25.089 4.94433 25.6167 5.59446 25.6167H10.3056C10.9557 25.6167 11.4834 25.089 11.4834 24.4389ZM14.3024 35.2656L10.971 38.5969C10.5111 39.0569 10.5111 39.8024 10.971 40.2623C11.2007 40.4926 11.5022 40.6074 11.8037 40.6074C12.1052 40.6074 12.4067 40.4926 12.6364 40.2623L15.9677 36.931C16.4277 36.4711 16.4277 35.7255 15.9677 35.2656C15.5084 34.8057 14.7617 34.8057 14.3024 35.2656ZM39.2866 35.2656C38.8266 34.8057 38.0811 34.8057 37.6212 35.2656C37.1613 35.7255 37.1613 36.4711 37.6212 36.931L40.9525 40.2623C41.1828 40.4926 41.4837 40.6074 41.7852 40.6074C42.0867 40.6074 42.3877 40.4926 42.6179 40.2623C43.0778 39.8024 43.0778 39.0569 42.6179 38.5969L39.2866 35.2656ZM47.9945 23.2611H43.2834C42.6332 23.2611 42.1056 23.7887 42.1056 24.4389C42.1056 25.089 42.6332 25.6167 43.2834 25.6167H47.9945C48.6446 25.6167 49.1722 25.089 49.1722 24.4389C49.1722 23.7887 48.6446 23.2611 47.9945 23.2611ZM38.4539 13.9572C38.7554 13.9572 39.0563 13.8424 39.2866 13.6122L42.6179 10.2808C43.0778 9.82089 43.0778 9.07535 42.6179 8.61543C42.158 8.15551 41.4125 8.15551 40.9525 8.61543L37.6212 11.9468C37.1613 12.4067 37.1613 13.1522 37.6212 13.6122C37.8509 13.8424 38.1524 13.9572 38.4539 13.9572ZM32.6834 42.1055C32.6834 42.7557 32.1557 43.2833 31.5056 43.2833H22.0834C21.4332 43.2833 20.9056 42.7557 20.9056 42.1055C20.9056 41.4784 21.3973 40.9702 22.0156 40.9348C21.2825 34.3075 14.4278 32.8311 14.4278 25.0278C14.4278 18.1978 19.9645 12.6611 26.7945 12.6611C33.6244 12.6611 39.1611 18.1978 39.1611 25.0278C39.1611 32.8311 32.3065 34.3075 31.5733 40.9348C32.1916 40.9702 32.6834 41.4784 32.6834 42.1055ZM24.0803 15.9648C23.8971 15.5131 23.383 15.2958 22.9296 15.4778C19.9198 16.6973 17.6378 19.3044 16.8258 22.4514C16.7039 22.9243 16.9883 23.4054 17.4606 23.5273C17.5342 23.5467 17.6084 23.5555 17.6814 23.5555C18.0748 23.5555 18.4334 23.2911 18.5365 22.893C19.209 20.2854 21.0993 18.1254 23.5927 17.1155C24.0449 16.9323 24.2628 16.4176 24.0803 15.9648Z" fill="#B3C0CC" fill-opacity="0.956863" />
                </svg>
                <div>
                    <div className='title-outer'>
                        <div className='title'>温故知新</div>
                        <div>PRO</div>
                    </div>
                    <div className='description'>标记单词随机生成阅读资料</div>
                </div>
            </div>
            <div className='list-item' onClick={() => {
                chrome.tabs.create({
                    url: '../../../home.html?item=2'
                });
            }}>
                <svg width="40" height="40" viewBox="0 0 51 51" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M37.8216 1.48407H12.2655C9.86342 1.48407 7.91522 3.43227 7.91522 5.83437V45.2574C7.91522 47.6595 9.86342 49.6077 12.2655 49.6077H23.0061H28.9782H37.8216C40.2237 49.6077 42.1719 47.6595 42.1719 45.2574V5.83437C42.1719 3.43227 40.2237 1.48407 37.8216 1.48407ZM20.8335 4.58487H29.2536C29.6718 4.58487 30.0135 4.92657 30.0135 5.34477C30.0135 5.76297 29.6718 6.10467 29.2536 6.10467H20.8335C20.4153 6.10467 20.0736 5.76297 20.0736 5.34477C20.0736 4.92657 20.4153 4.58487 20.8335 4.58487ZM25.0461 44.5587C23.3529 44.5587 21.981 43.1868 21.981 41.4936C21.981 39.8004 23.3529 38.4285 25.0461 38.4285C26.7393 38.4285 28.1112 39.8004 28.1112 41.4936C28.1061 43.1868 26.7342 44.5587 25.0461 44.5587ZM38.9895 33.2214C38.9895 33.8232 38.505 34.3077 37.9032 34.3077H12.1839C11.5821 34.3077 11.0976 33.8232 11.0976 33.2214V10.0674C11.0976 9.46557 11.5821 8.98107 12.1839 8.98107H37.8981C38.4999 8.98107 38.9844 9.46557 38.9844 10.0674V33.2214H38.9895Z" fill="#B3C0CC" />
                </svg>
                <div>
                    <div className='title-outer'>
                        <div className='title'>移动端</div>
                        <div>PRO</div>
                    </div>
                    <div className='description'>随时随地背单词</div>
                </div>
            </div>
            <div className='foot'>
                <div onClick={() => { }}>
                    <svg width="20" height="20" viewBox="0 0 30 30" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <g clip-path="url(#clip0_48_100)">
                            <path d="M15 29.0625C7.23375 29.0625 0.9375 22.7663 0.9375 15C0.9375 7.23375 7.23375 0.9375 15 0.9375C22.7663 0.9375 29.0625 7.23375 29.0625 15C29.0625 22.7663 22.7663 29.0625 15 29.0625ZM13.2694 14.0625V20.9859C13.2694 21.4066 13.4365 21.8101 13.734 22.1076C14.0315 22.4051 14.4349 22.5722 14.8556 22.5722C15.2763 22.5722 15.6798 22.4051 15.9773 22.1076C16.2748 21.8101 16.4419 21.4066 16.4419 20.9859V14.0625C16.4419 13.6418 16.2748 13.2383 15.9773 12.9409C15.6798 12.6434 15.2763 12.4762 14.8556 12.4762C14.4349 12.4762 14.0315 12.6434 13.734 12.9409C13.4365 13.2383 13.2694 13.6418 13.2694 14.0625ZM14.8444 7.42781C14.4131 7.42781 14.0466 7.56094 13.7437 7.87125C13.4203 8.16 13.2694 8.53688 13.2694 9.00375C13.2694 9.44719 13.4203 9.82406 13.7437 10.1353C14.0466 10.4456 14.4131 10.6012 14.8453 10.6012C15.2688 10.6019 15.6771 10.4433 15.9891 10.1569C16.2909 9.84656 16.4419 9.46969 16.4419 9.00375C16.4419 8.53781 16.2919 8.16 15.9891 7.87125C15.6872 7.56187 15.2981 7.42781 14.8453 7.42781H14.8444Z" fill="#B3C0CC" />
                        </g>
                        <defs>
                            <clipPath id="clip0_48_100">
                                <rect width="30" height="30" fill="white" />
                            </clipPath>
                        </defs>
                    </svg>
                    <div>关于</div>
                </div>
                <div onClick={() => {
                    chrome.tabs.create({
                        url: '../../home.html?item=4'
                    });
                }}>
                    <svg width="20" height="20" viewBox="0 0 31 29" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M15.9018 20.6673C17.1535 20.6673 18.3772 20.3056 19.4179 19.628C20.4587 18.9503 21.2699 17.9871 21.749 16.8601C22.228 15.7332 22.3533 14.4932 22.1091 13.2968C21.8649 12.1005 21.2621 11.0016 20.377 10.139C19.4919 9.27653 18.3642 8.68915 17.1365 8.45118C15.9088 8.21321 14.6362 8.33535 13.4798 8.80214C12.3233 9.26893 11.3349 10.0594 10.6394 11.0736C9.94399 12.0878 9.5728 13.2802 9.5728 14.5C9.57804 16.1341 10.2465 17.6998 11.4323 18.8553C12.6181 20.0108 14.2248 20.6622 15.9018 20.6673ZM1.12096 14.5C1.11936 13.4812 1.21902 12.4647 1.41856 11.4647C2.30205 11.3699 3.14913 11.0692 3.88815 10.5879C4.62717 10.1067 5.2364 9.45915 5.66432 8.70001C6.1204 7.90476 6.37782 7.01601 6.41574 6.10575C6.45366 5.19549 6.271 4.28933 5.88256 3.46068C7.45211 1.97537 9.34371 0.852224 11.4179 0.174011C11.9086 0.91626 12.5826 1.52669 13.378 1.94941C14.1735 2.37213 15.0651 2.59363 15.9712 2.59363C16.8773 2.59363 17.7689 2.37213 18.5644 1.94941C19.3598 1.52669 20.0338 0.91626 20.5245 0.174011C22.595 0.866732 24.4797 2.00305 26.04 3.49934C25.6641 4.32583 25.4917 5.2265 25.5364 6.12946C25.5812 7.03243 25.842 7.9127 26.2979 8.70001C26.7155 9.42646 27.3 10.0488 28.0056 10.5184C28.7112 10.988 29.5188 11.292 30.3651 11.4067C30.8041 13.5942 30.7635 15.8475 30.2461 18.0187C29.4124 18.1549 28.6217 18.4748 27.934 18.9539C27.2464 19.433 26.68 20.0587 26.2781 20.7833C25.8663 21.5019 25.6162 22.2976 25.5444 23.1176C25.4726 23.9376 25.5806 24.7632 25.8614 25.5393C24.2554 27.0555 22.3144 28.193 20.1872 28.8647C19.6826 28.234 19.037 27.7238 18.2995 27.3729C17.5621 27.022 16.7522 26.8396 15.9315 26.8396C15.1108 26.8396 14.301 27.022 13.5635 27.3729C12.8261 27.7238 12.1805 28.234 11.6758 28.8647C9.55545 28.2168 7.61476 27.106 6.0016 25.6167C6.30626 24.8268 6.43037 23.9816 6.36526 23.1401C6.30016 22.2986 6.0474 21.4811 5.62464 20.7447C5.21053 19.9966 4.62086 19.3545 3.90371 18.8707C3.18656 18.3869 2.36223 18.0751 1.49792 17.9607C1.24136 16.8242 1.11494 15.6636 1.12096 14.5Z" fill="#B3C0CC" />
                    </svg>
                    <div>设置</div>
                </div>
            </div>
        </div>
    )
}

const root = createRoot(document.getElementById('root'));
root.render(<PopUp></PopUp>);